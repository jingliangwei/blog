# 儒略日与公历

## 儒略日及公历的概念

- 儒略日：从公元前4713年1月1日正午12h开始的累计天数
- 公历：在1582年10月4日前使用儒略历（旧历），由于误差改为格力高历（新历），增加10天从1582年10月15日开始计算

::: info 修改原因
为了宗教事务上的方便，罗马教皇格雷果里十三世于公元1582年修改了儒略历。改历的内容有修正公元325年宗教会议以来所积累的10日的误差，格雷果里下令：这样，历史上就留下了10天空白。改历的内容有二个方面：一是使当时的春分回到3月21日，二是使以后的春分固定在3月21日。

详见[知乎](https://www.zhihu.com/question/21698547/answer/350392528)
:::

## 公历转儒略日

### 旧历转儒略日

::: tip 公式
`y`年`m`月`d`日的儒略日为`JD=int(365.25*(y+4712))+int(30.61*(m+1))+d-63.5`

要求日期在-4712年1月1日到1582年10月4日之间，并且当`m=1,2`时，要用`(y-1,m+12,d)`带入公式计算。
:::

下面进行推导：
1. 从-4712年1月1日到`y`年1月1日前一天累计天数：
- 当`y`为闰年，`JD1=int(365.25*(y+4712))`
- 当`y`为平年，`JD1=int(365.25*(y+4712))+1`
2. 从`y`年1月1日到`y`年`m`月1日前一天累计天数：

注意到（对于平年）

|`m`|累计天数|`int(30.61*(m+1))-63`|
|:--:|:--:|:--:|
|3|59|59|
|4|90|90|
|5|120|120|
|6|151|151|
|7|181|181|
|8|212|212|
|9|243|243|
|10|273|273|
|11|304|304|
|12|334|334|
|13(1月)|365|365|
|14(2月)|396|396|

当`m=1,2`时，先把年份`y`减1，月份`m`加12再带入公式。

- 当`y`为闰年，`JD2=int(30.61*(m+1))-63+1`
- 当`y`为平年，`JD2=int(30.61*(m+1))-63`
3. 从`y`年`m`月1日到`y`年`m`月`d`日累计天数：
`JD3=d-1` （`d`为小数，比如`d=1.5`代表2号12:00）
4. 综上并考虑到起算点是-4712年1月1日中午12h，要再减去半天：
`JD=JD1+JD2+JD3-0.5=int(365.25*(y+4712))+int(30.61*(m+1))+d-63.5`

### 新历转儒略日

::: tip 公式
`y`年`m`月`d`日的儒略日为`JD=int(365.25*(y+4712))+int(30.61*(m+1))+d-63.5+B`

`B=2-int(y/100)+int(y/400)`

要求日期在1582年10月15日之后，并且当`m=1,2`时，要用`(y-1,m+12,d)`带入公式计算。
:::

推导：

1. 以旧历公式为基础进行修正，由于旧历每四年一闰改为新历的每百年不能被400整除就不闰，按照原公式计算会把1582年以后百年中不需要闰的年份也闰了，这一部分的天数为 `B1=-int(y/100)+int(y/400)` ，但是这个公式又把0年到1582年应该闰的部分整百年没有闰，这样又少闰了12年，补上这12天后 `B1=12-int(y/100)+int(y/400)`
2. 由于从旧历到新历还直接空了10天，故 `B2=-10`
3. 综上，修正项 `B=B1+B2=2-int(y/100)+int(y/400)`

